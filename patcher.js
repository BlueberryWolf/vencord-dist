// Vencord 817f0f7
// Standalone: false
// Platform: win32
"use strict";var at=Object.create;var Ge=Object.defineProperty;var st=Object.getOwnPropertyDescriptor;var ct=Object.getOwnPropertyNames;var ut=Object.getPrototypeOf,lt=Object.prototype.hasOwnProperty;var C=(e,r)=>()=>(e&&(r=e(e=0)),r);var er=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of ct(r))!lt.call(e,i)&&i!==t&&Ge(e,i,{get:()=>r[i],enumerable:!(n=st(r,i))||n.enumerable});return e};var Oe=(e,r,t)=>(t=e!=null?at(ut(e)):{},er(r||!e||!e.__esModule?Ge(t,"default",{value:e,enumerable:!0}):t,e)),rr=e=>er(Ge({},"__esModule",{value:!0}),e);var l=C(()=>{"use strict"});var ve=C(()=>{"use strict";l()});function oe(e){return async function(){try{return{ok:!0,value:await e(...arguments)}}catch(r){return{ok:!1,error:r instanceof Error?{...r}:r}}}}var tr=C(()=>{"use strict";l()});var vt={};function Ie(...e){let r={cwd:sr};return ze?Ue("flatpak-spawn",["--host","git",...e],r):Ue("git",e,r)}async function ft(){return(await Ie("remote","get-url","origin")).stdout.trim().replace(/git@(.+):/,"https://$1/").replace(/\.git$/,"")}async function ht(){await Ie("fetch");let r=(await Ie("log","HEAD...origin/main","--pretty=format:%an/%h/%s")).stdout.trim();return r?r.split(`
`).map(t=>{let[n,i,...o]=t.split("/");return{hash:i,author:n,message:o.join("/")}}):[]}async function gt(){return(await Ie("pull")).stdout.includes("Fast-forward")}async function pt(){return!(await Ue(ze?"flatpak-spawn":"node",ze?["--host","node","scripts/build/build.mjs"]:["scripts/build/build.mjs"],{cwd:sr})).stderr.includes("Build failed")}var ir,ae,or,ar,sr,Ue,ze,cr=C(()=>{"use strict";l();ve();ir=require("child_process"),ae=require("electron"),or=require("path"),ar=require("util");tr();sr=(0,or.join)(__dirname,".."),Ue=(0,ar.promisify)(ir.execFile),ze=!1;ae.ipcMain.handle("VencordGetRepo",oe(ft));ae.ipcMain.handle("VencordGetUpdates",oe(ht));ae.ipcMain.handle("VencordUpdate",oe(gt));ae.ipcMain.handle("VencordBuild",oe(pt))});var ur=C(()=>{"use strict";l();Promise.resolve().then(()=>cr())});function hr(e){return new Promise((r,t)=>{let n=(0,fr.request)(new URL(e),{method:"HEAD"},i=>{r(i.headers.location?hr(i.headers.location):e)});n.on("error",t),n.end()})}var ce,lr,fr,se,It,gr=C(()=>{"use strict";l();ve();ce=require("electron"),lr=require("fs/promises"),fr=require("https"),se=require("path"),It=/^https:\/\/(spotify\.link|s\.team)\/.+$/;ce.ipcMain.handle("VencordOIAResolveRedirect",async(e,r)=>It.test(r)?hr(r):r);ce.ipcMain.handle("VencordVMReadRecording",async(e,r)=>{r=(0,se.normalize)(r);let t=(0,se.basename)(r),n=(0,se.normalize)(ce.app.getPath("userData")+"/");if(console.log(t,n,r),t!=="recording.ogg"||!r.startsWith(n))return null;try{let i=await(0,lr.readFile)(r);return new Uint8Array(i.buffer)}catch{return null}})});function _e(e,r=300){let t;return function(...n){clearTimeout(t),t=setTimeout(()=>{e(...n)},r)}}var pr=C(()=>{"use strict";l()});var ue,vr=C(()=>{"use strict";l();ue=class{constructor(r=1/0){this.maxSize=r}queue=[];promise;next(){let r=this.queue.shift();r?this.promise=Promise.resolve().then(r).finally(()=>this.next()):this.promise=void 0}run(){this.promise||this.next()}push(r){this.size>=this.maxSize&&this.queue.shift(),this.queue.push(r),this.run()}unshift(r){this.size>=this.maxSize&&this.queue.pop(),this.queue.unshift(r),this.run()}get size(){return this.queue.length}}});var Ir,mr=C(()=>{l();Ir="PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICAgIDxoZWFkPgogICAgICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgICAgIDx0aXRsZT5WZW5jb3JkIFF1aWNrQ1NTIEVkaXRvcjwvdGl0bGU+CiAgICAgICAgPGxpbmsKICAgICAgICAgICAgcmVsPSJzdHlsZXNoZWV0IgogICAgICAgICAgICBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuNDAuMC9taW4vdnMvZWRpdG9yL2VkaXRvci5tYWluLm1pbi5jc3MiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLU1Pb1EwMmg4MGhrbGNjZkxyWEZZa0N6RytXVmpPUmZsT3A5WnA4ZGx0aWFSUCszNUxZbk80TEtPa2xSNjRvTUdmR2dKRExPOFdKcGtNMW81Z1pYWVpRPT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICAvPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgI2NvbnRhaW5lciB7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwOwogICAgICAgICAgICAgICAgdG9wOiAwOwogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CiAgICA8L2hlYWQ+CgogICAgPGJvZHk+CiAgICAgICAgPGRpdiBpZD0iY29udGFpbmVyIj48L2Rpdj4KICAgICAgICA8c2NyaXB0CiAgICAgICAgICAgIHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbW9uYWNvLWVkaXRvci8wLjQwLjAvbWluL3ZzL2xvYWRlci5taW4uanMiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLVF6TXBYZUNQY2lBSFA0d2JZbFYyUFlnclFjYUVrRFFVanprUFU0eG5qeVZTRDlUMzYvdWRhbXh0TkJxYjRxSzQvYk1RTVBaOGF5ckJlOWhyR2RCRmpRPT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICA+PC9zY3JpcHQ+CgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIHJlcXVpcmUuY29uZmlnKHsKICAgICAgICAgICAgICAgIHBhdGhzOiB7CiAgICAgICAgICAgICAgICAgICAgdnM6ICJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuNDAuMC9taW4vdnMiLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXF1aXJlKFsidnMvZWRpdG9yL2VkaXRvci5tYWluIl0sICgpID0+IHsKICAgICAgICAgICAgICAgIGdldEN1cnJlbnRDc3MoKS50aGVuKChjc3MpID0+IHsKICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdG9yID0gbW9uYWNvLmVkaXRvci5jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250YWluZXIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiAiY3NzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiBnZXRUaGVtZSgpLAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBlZGl0b3Iub25EaWRDaGFuZ2VNb2RlbENvbnRlbnQoKCkgPT4KICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3NzKGVkaXRvci5nZXRWYWx1ZSgpKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBtb25hY28gcmUtbGF5b3V0CiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5sYXlvdXQoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICA8L3NjcmlwdD4KICAgIDwvYm9keT4KPC9odG1sPgo="});function ke(e,r={}){return{fileName:e,name:r.name??e.replace(/\.css$/i,""),author:r.author??"Unknown Author",description:r.description??"A Discord Theme.",version:r.version,license:r.license,source:r.source,website:r.website,invite:r.invite}}function Ar(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function Cr(e,r){if(!e)return ke(r);let t=e.split("/**",2)?.[1]?.split("*/",1)?.[0];if(!t)return ke(r);let n={},i="",o="";for(let a of t.split(mt))if(a.length!==0)if(a.charAt(0)==="@"&&a.charAt(1)!==" "){n[i]=o.trim();let c=a.indexOf(" ");i=a.substring(1,c),o=a.substring(c+1)}else o+=" "+a.replace("\\n",`
`).replace(At,"@");return n[i]=o.trim(),delete n[""],ke(r,n)}var mt,At,dr=C(()=>{"use strict";l();mt=/[^\S\r\n]*?\r?(?:\r\n|\n)[^\S\r\n]*?\*[^\S\r\n]?/,At=/^\\@/});var yr,B,me,le,M,Q,Ve,wr,Ae,fe=C(()=>{"use strict";l();yr=require("electron"),B=require("path"),me=process.env.VENCORD_USER_DATA_DIR??(process.env.DISCORD_USER_DATA_DIR?(0,B.join)(process.env.DISCORD_USER_DATA_DIR,"..","VencordData"):(0,B.join)(yr.app.getPath("userData"),"..","Vencord")),le=(0,B.join)(me,"settings"),M=(0,B.join)(me,"themes"),Q=(0,B.join)(le,"quickCss.css"),Ve=(0,B.join)(le,"settings.json"),wr=["https:","http:","steam:","spotify:","com.epicgames.launcher:"],Ae=process.argv.includes("--vanilla")});function Tr(e){e.webContents.setWindowOpenHandler(({url:r})=>{switch(r){case"about:blank":case"https://discord.com/popout":case"https://ptb.discord.com/popout":case"https://canary.discord.com/popout":return{action:"allow"}}try{var{protocol:t}=new URL(r)}catch{return{action:"deny"}}switch(t){case"http:":case"https:":case"mailto:":case"steam:":case"spotify:":Sr.shell.openExternal(r)}return{action:"deny"}})}var Sr,xr=C(()=>{"use strict";l();Sr=require("electron")});function Ne(e,r){let t=(0,X.normalize)(e),n=(0,X.join)(e,r),i=(0,X.normalize)(n);return i.startsWith(t)?i:null}function Er(){return(0,P.readFile)(Q,"utf-8").catch(()=>"")}async function Ct(){let e=await(0,P.readdir)(M).catch(()=>[]),r=[];for(let t of e){if(!t.endsWith(".css"))continue;let n=await Dr(t).then(Ar).catch(()=>null);n!=null&&r.push(Cr(n,t))}return r}function Dr(e){e=e.replace(/\?v=\d+$/,"");let r=Ne(M,e);return r?(0,P.readFile)(r,"utf-8"):Promise.reject(`Unsafe path ${e}`)}function Rr(){try{return(0,W.readFileSync)(Ve,"utf-8")}catch{return"{}"}}function Ce(){try{return JSON.parse(Rr())}catch{return{}}}function Pr(e){(0,P.open)(Q,"a+").then(r=>{r.close(),(0,W.watch)(Q,{persistent:!1},_e(async()=>{e.webContents.postMessage("VencordQuickCssUpdate",await Er())},50))}),(0,W.watch)(M,{persistent:!1},_e(()=>{e.webContents.postMessage("VencordThemeUpdate",void 0)}))}var A,W,P,X,dt,yt,Me=C(()=>{"use strict";l();ur();gr();pr();ve();vr();A=require("electron"),W=require("fs"),P=require("fs/promises"),X=require("path");mr();dr();fe();xr();(0,W.mkdirSync)(le,{recursive:!0});(0,W.mkdirSync)(M,{recursive:!0});A.ipcMain.handle("VencordOpenQuickCss",()=>A.shell.openPath(Q));A.ipcMain.handle("VencordOpenExternal",(e,r)=>{try{var{protocol:t}=new URL(r)}catch{throw"Malformed URL"}if(!wr.includes(t))throw"Disallowed protocol.";A.shell.openExternal(r)});dt=new ue,yt=new ue;A.ipcMain.handle("VencordGetQuickCss",()=>Er());A.ipcMain.handle("VencordSetQuickCss",(e,r)=>dt.push(()=>(0,P.writeFile)(Q,r)));A.ipcMain.handle("VencordGetThemesDir",()=>M);A.ipcMain.handle("VencordGetThemesList",()=>Ct());A.ipcMain.handle("VencordGetThemeData",(e,r)=>Dr(r));A.ipcMain.handle("VencordGetSettingsDir",()=>le);A.ipcMain.on("VencordGetSettings",e=>e.returnValue=Rr());A.ipcMain.handle("VencordSetSettings",(e,r)=>{yt.push(()=>(0,P.writeFile)(Ve,r))});A.ipcMain.handle("VencordOpenMonacoEditor",async()=>{let e=new A.BrowserWindow({title:"Vencord QuickCSS Editor",autoHideMenuBar:!0,darkTheme:!0,webPreferences:{preload:(0,X.join)(__dirname,"preload.js"),contextIsolation:!0,nodeIntegration:!1,sandbox:!1}});Tr(e),await e.loadURL(`data:text/html;base64,${Ir}`)})});function Jr(e,r,t){let n=r;if(r in e)return void t(e[n]);Object.defineProperty(e,r,{set(i){delete e[n],e[n]=i,t(i)},configurable:!0,enumerable:!1})}var $r=C(()=>{"use strict";l()});var Bt={};function Zt(e,r){let t=e.slice(4).split(".").map(Number),n=r.slice(4).split(".").map(Number);for(let i=0;i<n.length;i++){if(t[i]>n[i])return!0;if(t[i]<n[i])return!1}return!1}function Ft(){try{let e=(0,w.dirname)(process.execPath),r=(0,w.basename)(e),t=(0,w.join)(e,".."),n=(0,S.readdirSync)(t).reduce((c,s)=>s.startsWith("app-")&&Zt(s,c)?s:c,r);if(n===r)return;let i=(0,w.join)(t,n,"resources"),o=(0,w.join)(i,"app.asar"),a=(0,w.join)(i,"_app.asar");if(!(0,S.existsSync)(o)||(0,S.statSync)(o).isDirectory())return;console.info("[Vencord] Detected Host Update. Repatching..."),(0,S.renameSync)(o,a),(0,S.mkdirSync)(o),(0,S.writeFileSync)((0,w.join)(o,"package.json"),JSON.stringify({name:"discord",main:"index.js"})),(0,S.writeFileSync)((0,w.join)(o,"index.js"),`require(${JSON.stringify((0,w.join)(__dirname,"patcher.js"))});`)}catch(e){console.error("[Vencord] Failed to repatch latest host update",e)}}function jt(){let e=[(0,w.join)(require.main.filename,"..","autoStart","win32.js"),(0,w.join)(require.main.filename,"..","autoStart.js")];for(let r of e)try{let{update:t}=require(r);require.cache[r].exports.update=function(){t.apply(this,arguments),Ft()}}catch{}}var Ee,S,w,et,rt=C(()=>{"use strict";l();Ee=require("electron"),S=require("fs"),w=require("path"),{setAppUserModelId:et}=Ee.app;Ee.app.setAppUserModelId=function(e){Ee.app.setAppUserModelId=et,et.call(this,e),jt()}});var Yt={};var R,Z,Ht,Kt,be,bt,tt=C(()=>{"use strict";l();$r();R=Oe(require("electron")),Z=require("path");Me();fe();console.log("[Vencord] Starting up...");Ht=require.main.filename,Kt=require.main.path.endsWith("app.asar")?"_app.asar":"app.asar",be=(0,Z.join)((0,Z.dirname)(Ht),"..",Kt),bt=require((0,Z.join)(be,"package.json"));require.main.filename=(0,Z.join)(be,bt.main);R.app.setAppPath(be);if(Ae)console.log("[Vencord] Running in vanilla mode. Not loading Vencord");else{let e=Ce();if(rt(),e.winCtrlQ){let n=R.Menu.buildFromTemplate;R.Menu.buildFromTemplate=function(i){if(i[0]?.label==="&File"){let{submenu:o}=i[0];Array.isArray(o)&&o.push({label:"Quit (Hidden)",visible:!1,acceleratorWorksWhenHidden:!0,accelerator:"Control+Q",click:()=>R.app.quit()})}return n.call(this,i)}}class r extends R.default.BrowserWindow{constructor(i){if(i?.webPreferences?.preload&&i.title){let o=i.webPreferences.preload;i.webPreferences.preload=(0,Z.join)(__dirname,"preload.js"),i.webPreferences.sandbox=!1,e.frameless?i.frame=!1:e.winNativeTitleBar&&delete i.frame,e.transparentUNSAFE_USE_AT_OWN_RISK&&(i.transparent=!0,i.backgroundColor="#00000000"),e.macosTranslucency,process.env.DISCORD_PRELOAD=o,super(i),Pr(this)}else super(i)}}Object.assign(r,R.default.BrowserWindow),Object.defineProperty(r,"name",{value:"BrowserWindow",configurable:!0});let t=require.resolve("electron");delete require.cache[t].exports,require.cache[t].exports={...R.default,BrowserWindow:r},Jr(global,"appSettings",n=>{n.set("DANGEROUS_ENABLE_DEVTOOLS_ONLY_ENABLE_IF_YOU_KNOW_WHAT_YOURE_DOING",!0),e.disableMinSize?(n.set("MIN_WIDTH",0),n.set("MIN_HEIGHT",0)):(n.set("MIN_WIDTH",940),n.set("MIN_HEIGHT",500))}),process.env.DATA_DIR=(0,Z.join)(R.app.getPath("userData"),"..","Vencord")}console.log("[Vencord] Loading original Discord app.asar");require(require.main.filename)});l();var H=require("electron"),nt=require("path");Me();fe();l();var qr=require("electron");l();var Ur=require("module"),wt=(0,Ur.createRequire)("/"),ye,St=";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global";try{ye=wt("worker_threads").Worker}catch{}var Tt=ye?function(e,r,t,n,i){var o=!1,a=new ye(e+St,{eval:!0}).on("error",function(c){return i(c,null)}).on("message",function(c){return i(null,c)}).on("exit",function(c){c&&!o&&i(new Error("exited with code "+c),null)});return a.postMessage(t,n),a.terminate=function(){return o=!0,ye.prototype.terminate.call(a)},a}:function(e,r,t,n,i){setImmediate(function(){return i(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});var o=function(){};return{terminate:o,postMessage:o}},d=Uint8Array,L=Uint16Array,Ze=Uint32Array,Fe=new d([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),je=new d([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zr=new d([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_r=function(e,r){for(var t=new L(31),n=0;n<31;++n)t[n]=r+=1<<e[n-1];for(var i=new Ze(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)i[o]=o-t[n]<<5|n;return[t,i]},kr=_r(Fe,2),Be=kr[0],xt=kr[1];Be[28]=258,xt[258]=28;var Vr=_r(je,0),Nr=Vr[0],Un=Vr[1],Te=new L(32768);for(f=0;f<32768;++f)z=(f&43690)>>>1|(f&21845)<<1,z=(z&52428)>>>2|(z&13107)<<2,z=(z&61680)>>>4|(z&3855)<<4,Te[f]=((z&65280)>>>8|(z&255)<<8)>>>1;var z,f,J=function(e,r,t){for(var n=e.length,i=0,o=new L(r);i<n;++i)e[i]&&++o[e[i]-1];var a=new L(r);for(i=0;i<r;++i)a[i]=a[i-1]+o[i-1]<<1;var c;if(t){c=new L(1<<r);var s=15-r;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],h=r-e[i],v=a[e[i]-1]++<<h,E=v|(1<<h)-1;v<=E;++v)c[Te[v]>>>s]=u}else for(c=new L(n),i=0;i<n;++i)e[i]&&(c[i]=Te[a[e[i]-1]++]>>>15-e[i]);return c},he=new d(288);for(f=0;f<144;++f)he[f]=8;var f;for(f=144;f<256;++f)he[f]=9;var f;for(f=256;f<280;++f)he[f]=7;var f;for(f=280;f<288;++f)he[f]=8;var f,Mr=new d(32);for(f=0;f<32;++f)Mr[f]=5;var f;var Wr=J(he,9,1);var Lr=J(Mr,5,1),we=function(e){for(var r=e[0],t=1;t<e.length;++t)e[t]>r&&(r=e[t]);return r},x=function(e,r,t){var n=r/8|0;return(e[n]|e[n+1]<<8)>>(r&7)&t},Se=function(e,r){var t=r/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(r&7)},Zr=function(e){return(e+7)/8|0},xe=function(e,r,t){(r==null||r<0)&&(r=0),(t==null||t>e.length)&&(t=e.length);var n=new(e.BYTES_PER_ELEMENT==2?L:e.BYTES_PER_ELEMENT==4?Ze:d)(t-r);return n.set(e.subarray(r,t)),n};var Fr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],y=function(e,r,t){var n=new Error(r||Fr[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,y),!t)throw n;return n},jr=function(e,r,t){var n=e.length;if(!n||t&&t.f&&!t.l)return r||new d(0);var i=!r||t,o=!t||t.i;t||(t={}),r||(r=new d(n*3));var a=function(Xe){var Je=r.length;if(Xe>Je){var $e=new d(Math.max(Je*2,Xe));$e.set(r),r=$e}},c=t.f||0,s=t.p||0,u=t.b||0,h=t.l,v=t.d,E=t.m,_=t.n,ee=n*8;do{if(!h){c=x(e,s,1);var F=x(e,s+1,3);if(s+=3,F)if(F==1)h=Wr,v=Lr,E=9,_=5;else if(F==2){var V=x(e,s,31)+257,K=x(e,s+10,15)+4,re=V+x(e,s+5,31)+1;s+=14;for(var j=new d(re),te=new d(19),m=0;m<K;++m)te[zr[m]]=x(e,s+m*3,7);s+=K*3;for(var U=we(te),ge=(1<<U)-1,b=J(te,U,1),m=0;m<re;){var ne=b[x(e,s,ge)];s+=ne&15;var I=ne>>>4;if(I<16)j[m++]=I;else{var Y=0,pe=0;for(I==16?(pe=3+x(e,s,3),s+=2,Y=j[m-1]):I==17?(pe=3+x(e,s,7),s+=3):I==18&&(pe=11+x(e,s,127),s+=7);pe--;)j[m++]=Y}}var Ye=j.subarray(0,V),N=j.subarray(V);E=we(Ye),_=we(N),h=J(Ye,E,1),v=J(N,_,1)}else y(1);else{var I=Zr(s)+4,T=e[I-4]|e[I-3]<<8,k=I+T;if(k>n){o&&y(0);break}i&&a(u+T),r.set(e.subarray(I,k),u),t.b=u+=T,t.p=s=k*8,t.f=c;continue}if(s>ee){o&&y(0);break}}i&&a(u+131072);for(var it=(1<<E)-1,ot=(1<<_)-1,De=s;;De=s){var Y=h[Se(e,s)&it],q=Y>>>4;if(s+=Y&15,s>ee){o&&y(0);break}if(Y||y(2),q<256)r[u++]=q;else if(q==256){De=s,h=null;break}else{var qe=q-254;if(q>264){var m=q-257,ie=Fe[m];qe=x(e,s,(1<<ie)-1)+Be[m],s+=ie}var Re=v[Se(e,s)&ot],Pe=Re>>>4;Re||y(3),s+=Re&15;var N=Nr[Pe];if(Pe>3){var ie=je[Pe];N+=Se(e,s)&(1<<ie)-1,s+=ie}if(s>ee){o&&y(0);break}i&&a(u+131072);for(var Qe=u+qe;u<Qe;u+=4)r[u]=r[u-N],r[u+1]=r[u+1-N],r[u+2]=r[u+2-N],r[u+3]=r[u+3-N];u=Qe}}t.l=h,t.p=De,t.b=u,t.f=c,h&&(c=1,t.m=E,t.d=v,t.n=_)}while(!c);return u==r.length?r:xe(r,0,u)};var Et=new d(0);var Dt=function(e,r){var t={};for(var n in e)t[n]=e[n];for(var n in r)t[n]=r[n];return t},Gr=function(e,r,t){for(var n=e(),i=e.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<n.length;++a){var c=n[a],s=o[a];if(typeof c=="function"){r+=";"+s+"=";var u=c.toString();if(c.prototype)if(u.indexOf("[native code]")!=-1){var h=u.indexOf(" ",8)+1;r+=u.slice(h,u.indexOf("(",h))}else{r+=u;for(var v in c.prototype)r+=";"+s+".prototype."+v+"="+c.prototype[v].toString()}else r+=u}else t[s]=c}return[r,t]},de=[],Rt=function(e){var r=[];for(var t in e)e[t].buffer&&r.push((e[t]=new e[t].constructor(e[t])).buffer);return r},Pt=function(e,r,t,n){var i;if(!de[t]){for(var o="",a={},c=e.length-1,s=0;s<c;++s)i=Gr(e[s],o,a),o=i[0],a=i[1];de[t]=Gr(e[c],o,a)}var u=Dt({},de[t][1]);return Tt(de[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+r.toString()+"}",t,u,Rt(u),n)},Gt=function(){return[d,L,Ze,Fe,je,zr,Be,Nr,Wr,Lr,Te,Fr,J,we,x,Se,Zr,xe,y,jr,He,Br,Hr]};var Br=function(e){return postMessage(e,[e.buffer])},Hr=function(e){return e&&e.size&&new d(e.size)},Ot=function(e,r,t,n,i,o){var a=Pt(t,n,i,function(c,s){a.terminate(),o(c,s)});return a.postMessage([e,r],r.consume?[e.buffer]:[]),function(){a.terminate()}};var G=function(e,r){return e[r]|e[r+1]<<8},D=function(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24)>>>0},We=function(e,r){return D(e,r)+D(e,r+4)*4294967296};function Ut(e,r,t){return t||(t=r,r={}),typeof t!="function"&&y(7),Ot(e,r,[Gt],function(n){return Br(He(n.data[0],Hr(n.data[1])))},1,t)}function He(e,r){return jr(e,r)}var Le=typeof TextDecoder<"u"&&new TextDecoder,zt=0;try{Le.decode(Et,{stream:!0}),zt=1}catch{}var _t=function(e){for(var r="",t=0;;){var n=e[t++],i=(n>127)+(n>223)+(n>239);if(t+i>e.length)return[r,xe(e,t-1)];i?i==3?(n=((n&15)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,r+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?r+=String.fromCharCode((n&31)<<6|e[t++]&63):r+=String.fromCharCode((n&15)<<12|(e[t++]&63)<<6|e[t++]&63):r+=String.fromCharCode(n)}};function kt(e,r){if(r){for(var t="",n=0;n<e.length;n+=16384)t+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return t}else{if(Le)return Le.decode(e);var i=_t(e),o=i[0],a=i[1];return a.length&&y(8),o}}var Vt=function(e,r){return r+30+G(e,r+26)+G(e,r+28)},Nt=function(e,r,t){var n=G(e,r+28),i=kt(e.subarray(r+46,r+46+n),!(G(e,r+8)&2048)),o=r+46+n,a=D(e,r+20),c=t&&a==4294967295?Mt(e,o):[a,D(e,r+24),D(e,r+42)],s=c[0],u=c[1],h=c[2];return[G(e,r+10),s,u,i,o+G(e,r+30)+G(e,r+32),h]},Mt=function(e,r){for(;G(e,r)!=1;r+=4+G(e,r+2));return[We(e,r+12),We(e,r+4),We(e,r+20)]};var Or=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(e){e()};function Kr(e,r,t){t||(t=r,r={}),typeof t!="function"&&y(7);var n=[],i=function(){for(var I=0;I<n.length;++I)n[I]()},o={},a=function(I,T){Or(function(){t(I,T)})};Or(function(){a=t});for(var c=e.length-22;D(e,c)!=101010256;--c)if(!c||e.length-c>65558)return a(y(13,0,1),null),i;var s=G(e,c+8);if(s){var u=s,h=D(e,c+16),v=h==4294967295||u==65535;if(v){var E=D(e,c-12);v=D(e,E)==101075792,v&&(u=s=D(e,E+32),h=D(e,E+48))}for(var _=r&&r.filter,ee=function(I){var T=Nt(e,h,v),k=T[0],V=T[1],K=T[2],re=T[3],j=T[4],te=T[5],m=Vt(e,te);h=j;var U=function(b,ne){b?(i(),a(b,null)):(ne&&(o[re]=ne),--s||a(null,o))};if(!_||_({name:re,size:V,originalSize:K,compression:k}))if(!k)U(null,xe(e,m,m+V));else if(k==8){var ge=e.subarray(m,m+V);if(V<32e4)try{U(null,He(ge,new d(K)))}catch(b){U(b,null)}else n.push(Ut(ge,{size:K},U))}else U(y(14,"unknown compression type "+k,1),null);else U(null,null)},F=0;F<u;++F)ee(F)}else a(null,{});return i}var Qr=require("fs"),O=require("fs/promises"),$=require("path");fe();l();function br(e){function r(a,c,s,u){let h=0;return h+=a<<0,h+=c<<8,h+=s<<16,h+=u<<24>>>0,h}if(e[0]===80&&e[1]===75&&e[2]===3&&e[3]===4)return e;if(e[0]!==67||e[1]!==114||e[2]!==50||e[3]!==52)throw new Error("Invalid header: Does not start with Cr24");let t=e[4]===3,n=e[4]===2;if(!n&&!t||e[5]||e[6]||e[7])throw new Error("Unexpected crx format version number.");if(n){let a=r(e[8],e[9],e[10],e[11]),c=r(e[12],e[13],e[14],e[15]),s=16+a+c;return e.subarray(s,e.length)}let o=12+r(e[8],e[9],e[10],e[11]);return e.subarray(o,e.length)}l();var Yr=Oe(require("https"));function Ke(e,r={}){return new Promise((t,n)=>{Yr.default.get(e,r,i=>{let{statusCode:o,statusMessage:a,headers:c}=i;if(o>=400)return void n(`${o}: ${a} - ${e}`);if(o>=300)return void t(Ke(c.location,r));let s=[];i.on("error",n),i.on("data",u=>s.push(u)),i.once("end",()=>t(Buffer.concat(s)))})})}var Wt=(0,$.join)(me,"ExtensionCache");async function Lt(e,r){return await(0,O.mkdir)(r,{recursive:!0}),new Promise((t,n)=>{Kr(e,(i,o)=>{if(i)return void n(i);Promise.all(Object.keys(o).map(async a=>{if(a.startsWith("_metadata/"))return;if(a.endsWith("/"))return void(0,O.mkdir)((0,$.join)(r,a),{recursive:!0});let c=a.split("/"),s=c.pop(),u=c.join("/"),h=(0,$.join)(r,u);u&&await(0,O.mkdir)(h,{recursive:!0}),await(0,O.writeFile)((0,$.join)(h,s),o[a])})).then(()=>t()).catch(a=>{(0,O.rm)(r,{recursive:!0,force:!0}),n(a)})})})}async function Xr(e){let r=(0,$.join)(Wt,`${e}`);try{await(0,O.access)(r,Qr.constants.F_OK)}catch{let n=e==="fmkadmapgofadopljbjfkapdkoienihi"?"https://raw.githubusercontent.com/Vendicated/random-files/f6f550e4c58ac5f2012095a130406c2ab25b984d/fmkadmapgofadopljbjfkapdkoienihi.zip":`https://clients2.google.com/service/update2/crx?response=redirect&acceptformat=crx2,crx3&x=id%3D${e}%26uc&prodversion=32`,i=await Ke(n,{headers:{"User-Agent":"Vencord (https://github.com/Vendicated/Vencord)"}});await Lt(br(i),r).catch(console.error)}qr.session.defaultSession.loadExtension(r)}Ae||H.app.whenReady().then(()=>{H.protocol.registerFileProtocol("vencord",({url:n},i)=>{let o=n.slice(10);if(o.endsWith("/")&&(o=o.slice(0,-1)),o.startsWith("/themes/")){let a=o.slice(8),c=Ne(M,a);if(!c){i({statusCode:403});return}i(c.replace(/\?v=\d+$/,""));return}switch(o){case"renderer.js.map":case"vencordDesktopRenderer.js.map":case"preload.js.map":case"vencordDesktopPreload.js.map":case"patcher.js.map":case"vencordDesktopMain.js.map":i((0,nt.join)(__dirname,o));break;default:i({statusCode:403})}});try{Ce().enableReactDevtools&&Xr("fmkadmapgofadopljbjfkapdkoienihi").then(()=>console.info("[Vencord] Installed React Developer Tools")).catch(n=>console.error("[Vencord] Failed to install React Developer Tools",n))}catch{}let e=n=>{let i={};return n.split(";").forEach(o=>{let[a,...c]=o.trim().split(/\s+/g);a&&!Object.prototype.hasOwnProperty.call(i,a)&&(i[a]=c)}),i},r=n=>Object.entries(n).filter(([,i])=>i?.length).map(i=>i.flat().join(" ")).join("; ");function t(n,i){if(i in n){let o=e(n[i][0]);for(let a of["style-src","connect-src","img-src","font-src","media-src","worker-src"])o[a]=["*","blob:","data:","vencord:","'unsafe-inline'"];o["script-src"]??=[],o["script-src"].push("'unsafe-eval'","https://unpkg.com","https://cdnjs.cloudflare.com"),n[i]=[r(o)]}}H.session.defaultSession.webRequest.onHeadersReceived(({responseHeaders:n,resourceType:i},o)=>{n&&(i==="mainFrame"&&t(n,"content-security-policy"),i==="stylesheet"&&(n["content-type"]=["text/css"])),o({cancel:!1,responseHeaders:n})}),H.session.defaultSession.webRequest.onHeadersReceived=()=>{}});tt();
//# sourceURL=VencordPatcher
//# sourceMappingURL=vencord://patcher.js.map
/*! For license information please see patcher.js.LEGAL.txt */
