// Vencord 817f0f7
// Standalone: false
// Platform: win32
"use strict";var Oe=Object.create;var Fr=Object.defineProperty;var ke=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var Me=Object.getPrototypeOf,Ze=Object.prototype.hasOwnProperty;var cr=(r,e)=>()=>(r&&(e=r(r=0)),e);var Ne=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ve(e))!Ze.call(r,i)&&i!==t&&Fr(r,i,{get:()=>e[i],enumerable:!(n=ke(e,i))||n.enumerable});return r};var _e=(r,e,t)=>(t=r!=null?Oe(Me(r)):{},Ne(e||!r||!r.__esModule?Fr(t,"default",{value:r,enumerable:!0}):t,r));var f=cr(()=>{"use strict"});var ur=cr(()=>{"use strict";f()});function $(r){return async function(){try{return{ok:!0,value:await r(...arguments)}}catch(e){return{ok:!1,error:e instanceof Error?{...e}:e}}}}var Lr=cr(()=>{"use strict";f()});var Be={};function fr(...r){let e={cwd:Yr};return Tr?wr("flatpak-spawn",["--host","git",...r],e):wr("git",r,e)}async function We(){return(await fr("remote","get-url","origin")).stdout.trim().replace(/git@(.+):/,"https://$1/").replace(/\.git$/,"")}async function Fe(){await fr("fetch");let e=(await fr("log","HEAD...origin/main","--pretty=format:%an/%h/%s")).stdout.trim();return e?e.split(`
`).map(t=>{let[n,i,...o]=t.split("/");return{hash:i,author:n,message:o.join("/")}}):[]}async function Le(){return(await fr("pull")).stdout.includes("Fast-forward")}async function Ke(){return!(await wr(Tr?"flatpak-spawn":"node",Tr?["--host","node","scripts/build/build.mjs"]:["scripts/build/build.mjs"],{cwd:Yr})).stderr.includes("Build failed")}var Br,rr,Hr,jr,Yr,wr,Tr,Xr=cr(()=>{"use strict";f();ur();Br=require("child_process"),rr=require("electron"),Hr=require("path"),jr=require("util");Lr();Yr=(0,Hr.join)(__dirname,".."),wr=(0,jr.promisify)(Br.execFile),Tr=!1;rr.ipcMain.handle("VencordGetRepo",$(We));rr.ipcMain.handle("VencordGetUpdates",$(Fe));rr.ipcMain.handle("VencordUpdate",$(Le));rr.ipcMain.handle("VencordBuild",$(Ke))});f();var _=require("electron"),ze=require("path");f();f();Promise.resolve().then(()=>Xr());f();ur();var tr=require("electron"),Jr=require("fs/promises"),Qr=require("https"),er=require("path"),He=/^https:\/\/(spotify\.link|s\.team)\/.+$/;function qr(r){return new Promise((e,t)=>{let n=(0,Qr.request)(new URL(r),{method:"HEAD"},i=>{e(i.headers.location?qr(i.headers.location):r)});n.on("error",t),n.end()})}tr.ipcMain.handle("VencordOIAResolveRedirect",async(r,e)=>He.test(e)?qr(e):e);tr.ipcMain.handle("VencordVMReadRecording",async(r,e)=>{e=(0,er.normalize)(e);let t=(0,er.basename)(e),n=(0,er.normalize)(tr.app.getPath("userData")+"/");if(console.log(t,n,e),t!=="recording.ogg"||!e.startsWith(n))return null;try{let i=await(0,Jr.readFile)(e);return new Uint8Array(i.buffer)}catch{return null}});f();ur();f();var nr=class{constructor(e=1/0){this.maxSize=e}queue=[];promise;next(){let e=this.queue.shift();e?this.promise=Promise.resolve().then(e).finally(()=>this.next()):this.promise=void 0}run(){this.promise||this.next()}push(e){this.size>=this.maxSize&&this.queue.shift(),this.queue.push(e),this.run()}unshift(e){this.size>=this.maxSize&&this.queue.pop(),this.queue.unshift(e),this.run()}get size(){return this.queue.length}};var I=require("electron"),H=require("fs"),R=require("fs/promises"),B=require("path");f();var br="PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICAgIDxoZWFkPgogICAgICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgICAgIDx0aXRsZT5WZW5jb3JkIFF1aWNrQ1NTIEVkaXRvcjwvdGl0bGU+CiAgICAgICAgPGxpbmsKICAgICAgICAgICAgcmVsPSJzdHlsZXNoZWV0IgogICAgICAgICAgICBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuNDAuMC9taW4vdnMvZWRpdG9yL2VkaXRvci5tYWluLm1pbi5jc3MiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLU1Pb1EwMmg4MGhrbGNjZkxyWEZZa0N6RytXVmpPUmZsT3A5WnA4ZGx0aWFSUCszNUxZbk80TEtPa2xSNjRvTUdmR2dKRExPOFdKcGtNMW81Z1pYWVpRPT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICAvPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgI2NvbnRhaW5lciB7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwOwogICAgICAgICAgICAgICAgdG9wOiAwOwogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CiAgICA8L2hlYWQ+CgogICAgPGJvZHk+CiAgICAgICAgPGRpdiBpZD0iY29udGFpbmVyIj48L2Rpdj4KICAgICAgICA8c2NyaXB0CiAgICAgICAgICAgIHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbW9uYWNvLWVkaXRvci8wLjQwLjAvbWluL3ZzL2xvYWRlci5taW4uanMiCiAgICAgICAgICAgIGludGVncml0eT0ic2hhNTEyLVF6TXBYZUNQY2lBSFA0d2JZbFYyUFlnclFjYUVrRFFVanprUFU0eG5qeVZTRDlUMzYvdWRhbXh0TkJxYjRxSzQvYk1RTVBaOGF5ckJlOWhyR2RCRmpRPT0iCiAgICAgICAgICAgIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiCiAgICAgICAgICAgIHJlZmVycmVycG9saWN5PSJuby1yZWZlcnJlciIKICAgICAgICA+PC9zY3JpcHQ+CgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIHJlcXVpcmUuY29uZmlnKHsKICAgICAgICAgICAgICAgIHBhdGhzOiB7CiAgICAgICAgICAgICAgICAgICAgdnM6ICJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb25hY28tZWRpdG9yLzAuNDAuMC9taW4vdnMiLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXF1aXJlKFsidnMvZWRpdG9yL2VkaXRvci5tYWluIl0sICgpID0+IHsKICAgICAgICAgICAgICAgIGdldEN1cnJlbnRDc3MoKS50aGVuKChjc3MpID0+IHsKICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdG9yID0gbW9uYWNvLmVkaXRvci5jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250YWluZXIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiAiY3NzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiBnZXRUaGVtZSgpLAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBlZGl0b3Iub25EaWRDaGFuZ2VNb2RlbENvbnRlbnQoKCkgPT4KICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q3NzKGVkaXRvci5nZXRWYWx1ZSgpKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBtb25hY28gcmUtbGF5b3V0CiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5sYXlvdXQoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICA8L3NjcmlwdD4KICAgIDwvYm9keT4KPC9odG1sPgo=";f();var je=/[^\S\r\n]*?\r?(?:\r\n|\n)[^\S\r\n]*?\*[^\S\r\n]?/,Ye=/^\\@/;function Sr(r,e={}){return{fileName:r,name:e.name??r.replace(/\.css$/i,""),author:e.author??"Unknown Author",description:e.description??"A Discord Theme.",version:e.version,license:e.license,source:e.source,website:e.website,invite:e.invite}}function $r(r){return r.charCodeAt(0)===65279&&(r=r.slice(1)),r}function re(r,e){if(!r)return Sr(e);let t=r.split("/**",2)?.[1]?.split("*/",1)?.[0];if(!t)return Sr(e);let n={},i="",o="";for(let a of t.split(je))if(a.length!==0)if(a.charAt(0)==="@"&&a.charAt(1)!==" "){n[i]=o.trim();let c=a.indexOf(" ");i=a.substring(1,c),o=a.substring(c+1)}else o+=" "+a.replace("\\n",`
`).replace(Ye,"@");return n[i]=o.trim(),delete n[""],Sr(e,n)}f();var ee=require("electron"),Z=require("path"),lr=process.env.VENCORD_USER_DATA_DIR??(process.env.DISCORD_USER_DATA_DIR?(0,Z.join)(process.env.DISCORD_USER_DATA_DIR,"..","VencordData"):(0,Z.join)(ee.app.getPath("userData"),"..","Vencord")),ir=(0,Z.join)(lr,"settings"),N=(0,Z.join)(lr,"themes"),hr=(0,Z.join)(ir,"quickCss.css"),xr=(0,Z.join)(ir,"settings.json"),te=["https:","http:","steam:","spotify:","com.epicgames.launcher:"];f();var ne=require("electron");function ie(r){r.webContents.setWindowOpenHandler(({url:e})=>{switch(e){case"about:blank":case"https://discord.com/popout":case"https://ptb.discord.com/popout":case"https://canary.discord.com/popout":return{action:"allow"}}try{var{protocol:t}=new URL(e)}catch{return{action:"deny"}}switch(t){case"http:":case"https:":case"mailto:":case"steam:":case"spotify:":ne.shell.openExternal(e)}return{action:"deny"}})}(0,H.mkdirSync)(ir,{recursive:!0});(0,H.mkdirSync)(N,{recursive:!0});function Er(r,e){let t=(0,B.normalize)(r),n=(0,B.join)(r,e),i=(0,B.normalize)(n);return i.startsWith(t)?i:null}function Xe(){return(0,R.readFile)(hr,"utf-8").catch(()=>"")}async function Je(){let r=await(0,R.readdir)(N).catch(()=>[]),e=[];for(let t of r){if(!t.endsWith(".css"))continue;let n=await oe(t).then($r).catch(()=>null);n!=null&&e.push(re(n,t))}return e}function oe(r){r=r.replace(/\?v=\d+$/,"");let e=Er(N,r);return e?(0,R.readFile)(e,"utf-8"):Promise.reject(`Unsafe path ${r}`)}function ae(){try{return(0,H.readFileSync)(xr,"utf-8")}catch{return"{}"}}function se(){try{return JSON.parse(ae())}catch{return{}}}I.ipcMain.handle("VencordOpenQuickCss",()=>I.shell.openPath(hr));I.ipcMain.handle("VencordOpenExternal",(r,e)=>{try{var{protocol:t}=new URL(e)}catch{throw"Malformed URL"}if(!te.includes(t))throw"Disallowed protocol.";I.shell.openExternal(e)});var Qe=new nr,qe=new nr;I.ipcMain.handle("VencordGetQuickCss",()=>Xe());I.ipcMain.handle("VencordSetQuickCss",(r,e)=>Qe.push(()=>(0,R.writeFile)(hr,e)));I.ipcMain.handle("VencordGetThemesDir",()=>N);I.ipcMain.handle("VencordGetThemesList",()=>Je());I.ipcMain.handle("VencordGetThemeData",(r,e)=>oe(e));I.ipcMain.handle("VencordGetSettingsDir",()=>ir);I.ipcMain.on("VencordGetSettings",r=>r.returnValue=ae());I.ipcMain.handle("VencordSetSettings",(r,e)=>{qe.push(()=>(0,R.writeFile)(xr,e))});I.ipcMain.handle("VencordOpenMonacoEditor",async()=>{let r=new I.BrowserWindow({title:"Vencord QuickCSS Editor",autoHideMenuBar:!0,darkTheme:!0,webPreferences:{preload:(0,B.join)(__dirname,"vencordDesktopPreload.js"),contextIsolation:!0,nodeIntegration:!1,sandbox:!1}});ie(r),await r.loadURL(`data:text/html;base64,${br}`)});f();var De=require("electron");f();var fe=require("module"),be=(0,fe.createRequire)("/"),pr,$e=";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global";try{pr=be("worker_threads").Worker}catch{}var rt=pr?function(r,e,t,n,i){var o=!1,a=new pr(r+$e,{eval:!0}).on("error",function(c){return i(c,null)}).on("message",function(c){return i(null,c)}).on("exit",function(c){c&&!o&&i(new Error("exited with code "+c),null)});return a.postMessage(t,n),a.terminate=function(){return o=!0,pr.prototype.terminate.call(a)},a}:function(r,e,t,n,i){setImmediate(function(){return i(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});var o=function(){};return{terminate:o,postMessage:o}},m=Uint8Array,k=Uint16Array,Gr=Uint32Array,zr=new m([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Pr=new m([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),le=new m([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),he=function(r,e){for(var t=new k(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var i=new Gr(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)i[o]=o-t[n]<<5|n;return[t,i]},ge=he(zr,2),Ur=ge[0],et=ge[1];Ur[28]=258,et[258]=28;var pe=he(Pr,0),ve=pe[0],rn=pe[1],Cr=new k(32768);for(l=0;l<32768;++l)G=(l&43690)>>>1|(l&21845)<<1,G=(G&52428)>>>2|(G&13107)<<2,G=(G&61680)>>>4|(G&3855)<<4,Cr[l]=((G&65280)>>>8|(G&255)<<8)>>>1;var G,l,j=function(r,e,t){for(var n=r.length,i=0,o=new k(e);i<n;++i)r[i]&&++o[r[i]-1];var a=new k(e);for(i=0;i<e;++i)a[i]=a[i-1]+o[i-1]<<1;var c;if(t){c=new k(1<<e);var s=15-e;for(i=0;i<n;++i)if(r[i])for(var u=i<<4|r[i],h=e-r[i],g=a[r[i]-1]++<<h,T=g|(1<<h)-1;g<=T;++g)c[Cr[g]>>>s]=u}else for(c=new k(n),i=0;i<n;++i)r[i]&&(c[i]=Cr[a[r[i]-1]++]>>>15-r[i]);return c},or=new m(288);for(l=0;l<144;++l)or[l]=8;var l;for(l=144;l<256;++l)or[l]=9;var l;for(l=256;l<280;++l)or[l]=7;var l;for(l=280;l<288;++l)or[l]=8;var l,Ie=new m(32);for(l=0;l<32;++l)Ie[l]=5;var l;var Ce=j(or,9,1);var Ae=j(Ie,5,1),vr=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},w=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},Ir=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},me=function(r){return(r+7)/8|0},Ar=function(r,e,t){(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length);var n=new(r.BYTES_PER_ELEMENT==2?k:r.BYTES_PER_ELEMENT==4?Gr:m)(t-e);return n.set(r.subarray(e,t)),n};var de=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],d=function(r,e,t){var n=new Error(e||de[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,d),!t)throw n;return n},ye=function(r,e,t){var n=r.length;if(!n||t&&t.f&&!t.l)return e||new m(0);var i=!e||t,o=!t||t.i;t||(t={}),e||(e=new m(n*3));var a=function(Nr){var _r=e.length;if(Nr>_r){var Wr=new m(Math.max(_r*2,Nr));Wr.set(e),e=Wr}},c=t.f||0,s=t.p||0,u=t.b||0,h=t.l,g=t.d,T=t.m,z=t.n,X=n*8;do{if(!h){c=w(r,s,1);var V=w(r,s+1,3);if(s+=3,V)if(V==1)h=Ce,g=Ae,T=9,z=5;else if(V==2){var U=w(r,s,31)+257,W=w(r,s+10,15)+4,J=U+w(r,s+5,31)+1;s+=14;for(var M=new m(J),Q=new m(19),v=0;v<W;++v)Q[le[v]]=w(r,s+v*3,7);s+=W*3;for(var D=vr(Q),ar=(1<<D)-1,F=j(Q,D,1),v=0;v<J;){var q=F[w(r,s,ar)];s+=q&15;var p=q>>>4;if(p<16)M[v++]=p;else{var L=0,sr=0;for(p==16?(sr=3+w(r,s,3),s+=2,L=M[v-1]):p==17?(sr=3+w(r,s,7),s+=3):p==18&&(sr=11+w(r,s,127),s+=7);sr--;)M[v++]=L}}var Vr=M.subarray(0,U),O=M.subarray(U);T=vr(Vr),z=vr(O),h=j(Vr,T,1),g=j(O,z,1)}else d(1);else{var p=me(s)+4,y=r[p-4]|r[p-3]<<8,P=p+y;if(P>n){o&&d(0);break}i&&a(u+y),e.set(r.subarray(p,P),u),t.b=u+=y,t.p=s=P*8,t.f=c;continue}if(s>X){o&&d(0);break}}i&&a(u+131072);for(var Pe=(1<<T)-1,Ue=(1<<z)-1,mr=s;;mr=s){var L=h[Ir(r,s)&Pe],K=L>>>4;if(s+=L&15,s>X){o&&d(0);break}if(L||d(2),K<256)e[u++]=K;else if(K==256){mr=s,h=null;break}else{var Mr=K-254;if(K>264){var v=K-257,b=zr[v];Mr=w(r,s,(1<<b)-1)+Ur[v],s+=b}var dr=g[Ir(r,s)&Ue],yr=dr>>>4;dr||d(3),s+=dr&15;var O=ve[yr];if(yr>3){var b=Pr[yr];O+=Ir(r,s)&(1<<b)-1,s+=b}if(s>X){o&&d(0);break}i&&a(u+131072);for(var Zr=u+Mr;u<Zr;u+=4)e[u]=e[u-O],e[u+1]=e[u+1-O],e[u+2]=e[u+2-O],e[u+3]=e[u+3-O];u=Zr}}t.l=h,t.p=mr,t.b=u,t.f=c,h&&(c=1,t.m=T,t.d=g,t.n=z)}while(!c);return u==e.length?e:Ar(e,0,u)};var tt=new m(0);var nt=function(r,e){var t={};for(var n in r)t[n]=r[n];for(var n in e)t[n]=e[n];return t},ce=function(r,e,t){for(var n=r(),i=r.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<n.length;++a){var c=n[a],s=o[a];if(typeof c=="function"){e+=";"+s+"=";var u=c.toString();if(c.prototype)if(u.indexOf("[native code]")!=-1){var h=u.indexOf(" ",8)+1;e+=u.slice(h,u.indexOf("(",h))}else{e+=u;for(var g in c.prototype)e+=";"+s+".prototype."+g+"="+c.prototype[g].toString()}else e+=u}else t[s]=c}return[e,t]},gr=[],it=function(r){var e=[];for(var t in r)r[t].buffer&&e.push((r[t]=new r[t].constructor(r[t])).buffer);return e},ot=function(r,e,t,n){var i;if(!gr[t]){for(var o="",a={},c=r.length-1,s=0;s<c;++s)i=ce(r[s],o,a),o=i[0],a=i[1];gr[t]=ce(r[c],o,a)}var u=nt({},gr[t][1]);return rt(gr[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,u,it(u),n)},at=function(){return[m,k,Gr,zr,Pr,le,Ur,ve,Ce,Ae,Cr,de,j,vr,w,Ir,me,Ar,d,ye,Or,we,Te]};var we=function(r){return postMessage(r,[r.buffer])},Te=function(r){return r&&r.size&&new m(r.size)},st=function(r,e,t,n,i,o){var a=ot(t,n,i,function(c,s){a.terminate(),o(c,s)});return a.postMessage([r,e],e.consume?[r.buffer]:[]),function(){a.terminate()}};var x=function(r,e){return r[e]|r[e+1]<<8},S=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},Dr=function(r,e){return S(r,e)+S(r,e+4)*4294967296};function ct(r,e,t){return t||(t=e,e={}),typeof t!="function"&&d(7),st(r,e,[at],function(n){return we(Or(n.data[0],Te(n.data[1])))},1,t)}function Or(r,e){return ye(r,e)}var Rr=typeof TextDecoder<"u"&&new TextDecoder,ut=0;try{Rr.decode(tt,{stream:!0}),ut=1}catch{}var ft=function(r){for(var e="",t=0;;){var n=r[t++],i=(n>127)+(n>223)+(n>239);if(t+i>r.length)return[e,Ar(r,t-1)];i?i==3?(n=((n&15)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?e+=String.fromCharCode((n&31)<<6|r[t++]&63):e+=String.fromCharCode((n&15)<<12|(r[t++]&63)<<6|r[t++]&63):e+=String.fromCharCode(n)}};function lt(r,e){if(e){for(var t="",n=0;n<r.length;n+=16384)t+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return t}else{if(Rr)return Rr.decode(r);var i=ft(r),o=i[0],a=i[1];return a.length&&d(8),o}}var ht=function(r,e){return e+30+x(r,e+26)+x(r,e+28)},gt=function(r,e,t){var n=x(r,e+28),i=lt(r.subarray(e+46,e+46+n),!(x(r,e+8)&2048)),o=e+46+n,a=S(r,e+20),c=t&&a==4294967295?pt(r,o):[a,S(r,e+24),S(r,e+42)],s=c[0],u=c[1],h=c[2];return[x(r,e+10),s,u,i,o+x(r,e+30)+x(r,e+32),h]},pt=function(r,e){for(;x(r,e)!=1;e+=4+x(r,e+2));return[Dr(r,e+12),Dr(r,e+4),Dr(r,e+20)]};var ue=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(r){r()};function Se(r,e,t){t||(t=e,e={}),typeof t!="function"&&d(7);var n=[],i=function(){for(var p=0;p<n.length;++p)n[p]()},o={},a=function(p,y){ue(function(){t(p,y)})};ue(function(){a=t});for(var c=r.length-22;S(r,c)!=101010256;--c)if(!c||r.length-c>65558)return a(d(13,0,1),null),i;var s=x(r,c+8);if(s){var u=s,h=S(r,c+16),g=h==4294967295||u==65535;if(g){var T=S(r,c-12);g=S(r,T)==101075792,g&&(u=s=S(r,T+32),h=S(r,T+48))}for(var z=e&&e.filter,X=function(p){var y=gt(r,h,g),P=y[0],U=y[1],W=y[2],J=y[3],M=y[4],Q=y[5],v=ht(r,Q);h=M;var D=function(F,q){F?(i(),a(F,null)):(q&&(o[J]=q),--s||a(null,o))};if(!z||z({name:J,size:U,originalSize:W,compression:P}))if(!P)D(null,Ar(r,v,v+U));else if(P==8){var ar=r.subarray(v,v+U);if(U<32e4)try{D(null,Or(ar,new m(W)))}catch(F){D(F,null)}else n.push(ct(ar,{size:W},D))}else D(d(14,"unknown compression type "+P,1),null);else D(null,null)},V=0;V<u;++V)X(V)}else a(null,{});return i}var Re=require("fs"),E=require("fs/promises"),Y=require("path");f();function xe(r){function e(a,c,s,u){let h=0;return h+=a<<0,h+=c<<8,h+=s<<16,h+=u<<24>>>0,h}if(r[0]===80&&r[1]===75&&r[2]===3&&r[3]===4)return r;if(r[0]!==67||r[1]!==114||r[2]!==50||r[3]!==52)throw new Error("Invalid header: Does not start with Cr24");let t=r[4]===3,n=r[4]===2;if(!n&&!t||r[5]||r[6]||r[7])throw new Error("Unexpected crx format version number.");if(n){let a=e(r[8],r[9],r[10],r[11]),c=e(r[12],r[13],r[14],r[15]),s=16+a+c;return r.subarray(s,r.length)}let o=12+e(r[8],r[9],r[10],r[11]);return r.subarray(o,r.length)}f();var Ee=_e(require("https"));function kr(r,e={}){return new Promise((t,n)=>{Ee.default.get(r,e,i=>{let{statusCode:o,statusMessage:a,headers:c}=i;if(o>=400)return void n(`${o}: ${a} - ${r}`);if(o>=300)return void t(kr(c.location,e));let s=[];i.on("error",n),i.on("data",u=>s.push(u)),i.once("end",()=>t(Buffer.concat(s)))})})}var vt=(0,Y.join)(lr,"ExtensionCache");async function It(r,e){return await(0,E.mkdir)(e,{recursive:!0}),new Promise((t,n)=>{Se(r,(i,o)=>{if(i)return void n(i);Promise.all(Object.keys(o).map(async a=>{if(a.startsWith("_metadata/"))return;if(a.endsWith("/"))return void(0,E.mkdir)((0,Y.join)(e,a),{recursive:!0});let c=a.split("/"),s=c.pop(),u=c.join("/"),h=(0,Y.join)(e,u);u&&await(0,E.mkdir)(h,{recursive:!0}),await(0,E.writeFile)((0,Y.join)(h,s),o[a])})).then(()=>t()).catch(a=>{(0,E.rm)(e,{recursive:!0,force:!0}),n(a)})})})}async function Ge(r){let e=(0,Y.join)(vt,`${r}`);try{await(0,E.access)(e,Re.constants.F_OK)}catch{let n=r==="fmkadmapgofadopljbjfkapdkoienihi"?"https://raw.githubusercontent.com/Vendicated/random-files/f6f550e4c58ac5f2012095a130406c2ab25b984d/fmkadmapgofadopljbjfkapdkoienihi.zip":`https://clients2.google.com/service/update2/crx?response=redirect&acceptformat=crx2,crx3&x=id%3D${r}%26uc&prodversion=32`,i=await kr(n,{headers:{"User-Agent":"Vencord (https://github.com/Vendicated/Vencord)"}});await It(xe(i),e).catch(console.error)}De.session.defaultSession.loadExtension(e)}_.app.whenReady().then(()=>{_.protocol.registerFileProtocol("vencord",({url:n},i)=>{let o=n.slice(10);if(o.endsWith("/")&&(o=o.slice(0,-1)),o.startsWith("/themes/")){let a=o.slice(8),c=Er(N,a);if(!c){i({statusCode:403});return}i(c.replace(/\?v=\d+$/,""));return}switch(o){case"renderer.js.map":case"vencordDesktopRenderer.js.map":case"preload.js.map":case"vencordDesktopPreload.js.map":case"patcher.js.map":case"vencordDesktopMain.js.map":i((0,ze.join)(__dirname,o));break;default:i({statusCode:403})}});try{se().enableReactDevtools&&Ge("fmkadmapgofadopljbjfkapdkoienihi").then(()=>console.info("[Vencord] Installed React Developer Tools")).catch(n=>console.error("[Vencord] Failed to install React Developer Tools",n))}catch{}let r=n=>{let i={};return n.split(";").forEach(o=>{let[a,...c]=o.trim().split(/\s+/g);a&&!Object.prototype.hasOwnProperty.call(i,a)&&(i[a]=c)}),i},e=n=>Object.entries(n).filter(([,i])=>i?.length).map(i=>i.flat().join(" ")).join("; ");function t(n,i){if(i in n){let o=r(n[i][0]);for(let a of["style-src","connect-src","img-src","font-src","media-src","worker-src"])o[a]=["*","blob:","data:","vencord:","'unsafe-inline'"];o["script-src"]??=[],o["script-src"].push("'unsafe-eval'","https://unpkg.com","https://cdnjs.cloudflare.com"),n[i]=[e(o)]}}_.session.defaultSession.webRequest.onHeadersReceived(({responseHeaders:n,resourceType:i},o)=>{n&&(i==="mainFrame"&&t(n,"content-security-policy"),i==="stylesheet"&&(n["content-type"]=["text/css"])),o({cancel:!1,responseHeaders:n})}),_.session.defaultSession.webRequest.onHeadersReceived=()=>{}});
//# sourceURL=VencordDesktopMain
//# sourceMappingURL=vencord://vencordDesktopMain.js.map
/*! For license information please see vencordDesktopMain.js.LEGAL.txt */
